SELECT c6, c7, c8, MAX(c17) FROM t2 GROUP BY c8, c6, c7 ORDER BY c8 ASC, c17 DESC, c7 ASC