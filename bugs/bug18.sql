SELECT t4.c13, t4.c14, t4.c13, SUM(t4.c12) FROM t4 JOIN t1 AS t1_dup ON t4.c12 <= t4.c12 WHERE t4.c13 >= NOT c14 IS NULL GROUP BY c12, c12, c12 HAVING t4.c13 >= 30 ORDER BY c12 DESC LIMIT 10