SELECT c12, COUNT(c13), c14 FROM t4 CROSS JOIN t2 ON c12 <= t2.c8 WHERE c13 > NOT c6 IS NULL GROUP BY c14, c12 ORDER BY c6 DESC, c17 DESC