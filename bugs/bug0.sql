SELECT c3, MAX(c4), c5, COUNT(c16) FROM t1 LEFT JOIN t2 ON c4 >= t2.c8 WHERE c3 >= NOT FALSE GROUP BY c5, c3 ORDER BY c8 DESC, c6 ASC