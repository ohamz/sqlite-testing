SELECT COUNT(c6), MIN(c7), c8, MAX(c17) FROM t2 LEFT JOIN t1 ON c6 = t1.c5 WHERE c6 <= NOT c8 IS NULL OR NOT FALSE GROUP BY c8 HAVING c6 <> 31 ORDER BY c5 DESC LIMIT 91